---
title: "Logiciels stats - R - TP5"
author: "FX Jollois"
date: "13 avril 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)
```

## Importation des données

En premier lieu, on importe les données, puis on assemble les deux fichiers en un seul jeu de données, dans lequel on modifie les noms de variables (étape $1$ et $2$ du TP).

```{r importation}
pen.tra = read.table("pendigits.tra", sep = ",")
pen.tes = read.table("pendigits.tes", sep = ",")
pen = rbind(pen.tra, pen.tes)
names(pen) = c(paste(c("X", "Y"), rep(1:8, each = 2), sep = ""), "chiffre")
```

## Un peu de dénombrement

Chaque chiffre est écrit en moyenne `r round(nrow(pen)/10)` fois, avec quelques variations entre les chiffres

```{r occurences-table, results='asis'}
occur.chiffre = setNames(data.frame(table(pen$chiffre)), c("chiffre", "occurences"))
knitr::kable(occur.chiffre)
```

```{r occurences-plot}
ggplot(occur.chiffre, aes(chiffre, fill = chiffre)) + geom_bar(aes(weight=occurences)) +
    ylab("")
```

## Dessin d'un chiffre

Pour répondre à la question $3$, il nous faut une fonction permettant de dessiner un chiffre.

```{r}
dessineChiffre <- function(v, titre = NULL) {
    if (is.data.frame(v))
        v = unlist(v)
    don = data.frame(
        x = v[seq(1,15,by=2)],
        y = v[seq(2,16,by=2)],
        position = 1:8
    )
    g = ggplot(don, aes(x, y)) + xlim(0, 100) + ylim(0, 100) +
        geom_polygon(fill = "white", col = "black") +
        geom_text(aes(label = position)) + 
        theme_void() 
    if (!is.null(titre))
        g = g + ggtitle(titre)
    g
}
# pour tester : dessineChiffre(pen.tra[1,1:16], pen.tra[1,17])
```

Voici donc le premier exemple de chaque chiffre. On utilise ici le package `gridExtra` pour pouvoir mettre plusieurs graphiques sur la même page. Et on se base sur le fait que la fonction `ggplot()` renvoie un obet stockable, et donc la fonction `dessineChiffre()` aussi.

```{r}
premier = lapply(0:9, function(ch) {
    prem = subset(pen, chiffre == ch)[1,]
    dessineChiffre(prem, ch)
})
marrangeGrob(premier, nrow = 2, ncol = 5)
```
